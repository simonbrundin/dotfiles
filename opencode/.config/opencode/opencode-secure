#!/bin/bash
# Wrapper to run opencode with 1Password secrets
# Usage: opencode [args...]

ENV_FILE="$HOME/repos/dotfiles/opencode/.config/opencode/.env"

if [[ -f "$ENV_FILE" ]]; then
  OP_OUTPUT=$(op run --quiet --env-file="$ENV_FILE" -- env 2>/dev/null)
  eval "$OP_OUTPUT"
  exec opencode "$@"
else
  echo "Error: $ENV_FILE not found"
  exit 1
fi
